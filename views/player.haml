%script{src: '/script/jquery.tablesorter.min.js'}
:javascript
  $(document).ready(function() {
    $("#score_data").tablesorter();
  });
%h1 プレイヤーデータ

%dl
  %dt 最終更新日時
  %dd= @last_updated_at

%h2 プロフィール
%table
  %tbody
    %tr
      %td ID
      %td= @prof.id.to_s.rjust(6, '0')
    %tr
      %td 通り名
      %td= @prof.pseudonym
    %tr
      %td プレイヤー名
      %td= @prof.name
    %tr
      %td コメント
      %td= @prof.comment
    - if @prof.team
      %tr
        %td チームID
        %td= @prof.team.id
      %tr
        %td チーム名
        %td= @prof.team.name
    - else
      %tr
        %td チーム
        %td 所属なし
    %tr
      %td プレー数
      %td= @prof.play_count
    %tr
      %td 総スタンプ数
      %td= @prof.stamp
    %tr
      %td 総おにぎり数
      %td= @prof.onigiri
    %tr
      %td 最終プレー日時
      %td= @prof.last_play_date
    %tr
      %td 最終プレー店舗
      %td= @prof.last_play_shop

%h2 楽曲データ
%table#score_data
  %thead
    %tr
      %th{rowspan: 2} 楽曲名
      %th{colspan: 3} BASIC
      %th{colspan: 3} MEDIUM
      %th{colspan: 3} HARD
    %tr
      %th AR
      %th MISS
      %th RANK
      %th AR
      %th MISS
      %th RANK
      %th AR
      %th MISS
      %th RANK
  %tbody
    - @song.each do |name, score|
      %tr
        %td= CGI.escapeHTML(name)
        - if score[:basic]
          %td== #{score[:basic][:achieve]}%
          - case score[:basic][:miss]
          - when 0
            %td.fullcombo FC
          - when 1
            %td.miss1 1
          - when 2
            %td.miss2 2
          - else
            %td= score[:basic][:miss]
          %td= score[:basic][:rank]
        - else
          %td.noplay{colspan: 3} NO PLAY
        - if score[:medium]
          %td== #{score[:medium][:achieve]}%
          - case score[:medium][:miss]
          - when 0
            %td.fullcombo FC
          - when 1
            %td.miss1 1
          - when 2
            %td.miss2 2
          - else
            %td= score[:medium][:miss]
          %td= score[:medium][:rank]
        - else
          %td.noplay{colspan: 3} NO PLAY
        - if score[:hard]
          %td== #{score[:hard][:achieve]}%
          - case score[:hard][:miss]
          - when 0
            %td.fullcombo FC
          - when 1
            %td.miss1 1
          - when 2
            %td.miss2 2
          - else
            %td= score[:hard][:miss]
          %td= score[:hard][:rank]
        - else
          %td.noplay{colspan: 3} NO PLAY
%p== 計 #{@song.size} 曲
